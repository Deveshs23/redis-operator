(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{363:function(s,e,t){s.exports=t.p+"assets/img/redis-standalone.a6152d9b.png"},364:function(s,e,t){s.exports=t.p+"assets/img/redis-cluster-setup.c1d7206d.png"},383:function(s,e,t){"use strict";t.r(e);var a=t(45),n=Object(a.a)({},(function(){var s=this,e=s.$createElement,a=s._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"redis-setup"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#redis-setup"}},[s._v("#")]),s._v(" Redis Setup")]),s._v(" "),a("p",[s._v("This redis operator supports below deployment strategies for redis:-")]),s._v(" "),a("ul",[a("li",[s._v("Redis in-build master slave with sharding and replication mode")]),s._v(" "),a("li",[s._v("Redis standalone setup")])]),s._v(" "),a("p",[s._v("Here we will see how we can leverage these strategies.")]),s._v(" "),a("h2",{attrs:{id:"redis-standalone"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#redis-standalone"}},[s._v("#")]),s._v(" Redis Standalone")]),s._v(" "),a("div",{attrs:{align:"center"}},[a("img",{attrs:{src:t(363),height:"400",width:"400"}})]),s._v(" "),a("p",[s._v("In redis standalone mode, we deploy redis as a single Stateful pod which means ease of setup, no complexity, no high availability, and no resilience.")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ helm upgrade redis ot-helm/redis-setup "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    --set "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("setupMode")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"standalone"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    --install --namespace redis-operator\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nRelease "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"redis"')]),s._v(" does not exist. Installing it now.\nNAME: redis\nLAST DEPLOYED: Sun May  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(":59:48 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("\nNAMESPACE: redis-operator\nSTATUS: deployed\nREVISION: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nTEST SUITE: None\n")])])]),a("p",[s._v("Verify the standalone redis setup by "),a("code",[s._v("kubectl")]),s._v(" command line.")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ kubectl get pods -n redis-operator\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nNAME                              READY   STATUS    RESTARTS   AGE\nredis-operator-74b6cbf5c5-td8t7   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          81m\nredis-standalone-0                "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("/2     Running   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          56s\n")])])]),a("h2",{attrs:{id:"redis-cluster"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#redis-cluster"}},[s._v("#")]),s._v(" Redis Cluster")]),s._v(" "),a("div",{attrs:{align:"center"}},[a("img",{attrs:{src:t(364),height:"450",width:"400"}})]),s._v(" "),a("p",[s._v("A Redis cluster is simply a "),a("a",{attrs:{href:"https://www.digitalocean.com/community/tutorials/understanding-database-sharding",target:"_blank",rel:"noopener noreferrer"}},[s._v("data sharding strategy"),a("OutboundLink")],1),s._v(". It automatically partitions data across multiple Redis nodes. It is an advanced feature of Redis which achieves distributed storage and prevents a single point of failure.")]),s._v(" "),a("p",[s._v("For redis cluster setup we can use same helm command but with different parameters.")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ helm upgrade redis-cluster ot-helm/redis-setup "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    --set "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("setupMode")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cluster"')]),s._v(" --set cluster.size"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    --install --namespace redis-operator\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nRelease "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"redis-cluster"')]),s._v(" does not exist. Installing it now.\nNAME: redis-cluster\nLAST DEPLOYED: Sun May  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":11:38 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("\nNAMESPACE: redis-operator\nSTATUS: deployed\nREVISION: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nTEST SUITE: None\n")])])]),a("p",[s._v("Verify the cluster by checking the pod status of master and slave pods.")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ kubectl get pods -n redis-operator\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nNAME                              READY   STATUS    RESTARTS   AGE\nredis-operator-74b6cbf5c5-td8t7   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("          90m\nredis-slave-0                     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("/2     Running   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          75s\nredis-master-0                    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("/2     Running   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          76s\nredis-slave-1                     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("/2     Running   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          54s\nredis-master-1                    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("/2     Running   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          49s\nredis-slave-2                     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("/2     Running   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          35s\nredis-master-2                    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("/2     Running   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          26s\n")])])]),a("p",[s._v("If all the pods are in the running state of master and slave Statefulsets, then we can check the health of the redis cluster by using "),a("code",[s._v("redis-cli")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ kubectl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it redis-master-0 -n redis-operator -- redis-cli -a Opstree@1234 cluster nodes\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nDefaulting container name to redis-master.\nUse "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'kubectl describe pod/redis-master-0 -n redis-operator'")]),s._v(" to see all of the containers "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" this pod.\nWarning: Using a password with "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'-a'")]),s._v(" or "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'-u'")]),s._v(" option on the "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("command")]),s._v(" line interface may not be safe.\n528438a759cee4528c3071d17d75b27b0818555d "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.42")]),s._v(".0.219:6379@16379 myself,master - "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1619952294000")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" connected "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("-5460\n8ec7812903b7e046bec2f2a7bce4a9ccadfa4188 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.42")]),s._v(".0.221:6379@16379 slave d0ff3892d2eba0b2707199cb5df57adbba214bcd "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1619952297241")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" connected\n60f932272322bafbd8c3e16328d26af676aeb8d6 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.42")]),s._v(".0.220:6379@16379 slave 6e80da4902802ebffa94cbac9b7d98e9fd74121f "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1619952297000")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" connected\n6e80da4902802ebffa94cbac9b7d98e9fd74121f "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.42")]),s._v(".2.178:6379@16379 master - "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1619952297000")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" connected "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5461")]),s._v("-10922\nd0ff3892d2eba0b2707199cb5df57adbba214bcd "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.42")]),s._v(".1.178:6379@16379 master - "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1619952298245")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" connected "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10923")]),s._v("-16383\nc2b74bd2a360068db01dfc8f00b8d0b012e21215 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.42")]),s._v(".1.177:6379@16379 slave 528438a759cee4528c3071d17d75b27b0818555d "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1619952297000")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" connected\n")])])])])}),[],!1,null,null,null);e.default=n.exports}}]);